<link rel="import" href="../components/paper-dropdown/paper-dropdown-menu.html">
<link rel="import" href="../components/paper-ripple/paper-ripple.html">
<link rel="import" href="../components/core-ajax/core-ajax.html">

<link rel="import" href="../duarte-components/duarte-map.html">

<polymer-element name="duarte-profile">
	<template>
		<style>

			.container {
				max-width: 900px;
				margin-top: 28px;
				margin-left: auto;
				margin-right: auto;
				padding-left: 32px;
				padding-right: 32px;
			}

			.profile-name {
				font-weight: 100;
				font-size: 3em;
			}

			.heading {
				text-transform: uppercase;
				font-weight: 700;
				color: #777;
			}

			#maps-container {
				max-width: 1128px;
				margin-top: 32px;
				margin-left: auto;
				margin-right: auto;
			}

			.map {
				box-sizing: border-box;
				cursor: pointer;
				border-radius: 4px;
				background-color: #ffffff;
				width: 250px;
				height: 310px;
				position: relative;
				float: left;
				display: inline-block;
				transition: background-color 0.4s;
				margin: 16px;
				padding: 16px;
			}

			.map:active {
				background-color: #ddd;
			}

			.map-title {
				margin-top: 16px;
				font-weight: 300;
				color: #444;
				font-size: 1.7em;

				text-overflow: ellipsis;
				overflow: hidden;
				white-space: nowrap;
			}

			.map-creator {
				color: #444;
			}

			.map-ripple {
				color: #009688;
			}

			.duarte-thumbnail {
				width: 220px;
				height: 220px;
			}
			
		</style>

			<div class="container">
				<div class="profile-name">{{user.username}}</div>

				<div class="heading">My maps</div>

				<div id="maps-container">
					<core-ajax
						id="get"
						auto="true"
						method="get"
						url="http://192.168.0.189:8080/level/my"
						on-core-response="{{onResponse}}"
						contentType="application/json"
						withCredentials="true"
						></core-ajax>

					<template repeat="{{map in levels}}">
						<a is="pushstate-anchor" href="/play?id={{map._id}}">
							<paper-shadow z="1" vertical layout class="map" on-tap="{{mapClick}}">
								<paper-shadow z="1"></paper-shadow>
								<duarte-map grid="{{map.grid}}" class="duarte-thumbnail">
									<paper-ripple fit class="map-ripple"></paper-ripple>
								</duarte-map>

								<div class="map-title">{{map.title}}</div>
							</paper-shadow>
						</a>
					</template>
				</div>

			</div>

	</template>
	<script>
		Polymer('duarte-profile', {
			onResponse: function(e, detail) {
				this.levels = JSON.parse(detail.response);
				console.log(this.levels);
		  	}
		});
  </script>
</polymer-element>