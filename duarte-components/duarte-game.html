<link rel="import" href="../components/core-ajax/core-ajax.html">
<link rel="import" href="../components/paper-button/paper-button.html">

<script type="text/javascript" src="../js/jquery.js"></script>
<script type="text/javascript" src="../js/gameoptions.js"></script>
<script type="text/javascript" src="../js/level.js"></script>
<script type="text/javascript" src="../js/game.js"></script>
<script type="text/javascript" src="../js/entities.js"></script>

<polymer-element name="duarte-game" attributes="gameMode">
	<template>

	<style type="text/css">

		:host {
			display: block;
			position: relative;
			width: 600px;
			height: 600px;
			margin-bottom: 48px;
			margin-top: 42px;
			margin-left: auto;
			margin-right: auto;
			padding: 0;
		}

		.g_food {
			position: absolute;
			background-color: #4CAF50;
			z-index: 1;
		}

		.g_obstacle {
			position: absolute;
			background-color: #00ff00;
			z-index: 1;
		}

		.g_bug {
			position: absolute;
			background-color: #03A9F4;
			z-index: 1;
		}

		.g_player {
			transition: all 50ms;
			position: absolute;
			background-color: #009688;
			z-index: 2;
		}

		.g_tail {
			position: absolute;
			background-color: #4DB6AC;
			z-index: 1;
		}

		.g_pointer {
			position: absolute;
			background-color: #ff0000;
			z-index: 1;
		}

		.game-ripple {
			position: absolute;
			display: block;
			top: 100px;
			left: 0;
			width: 600px;
			height: 500px;
			z-index: 3;
		}

		#foodRipple {
			color: #4CAF50;
		}

		#bugRipple {
			color: #03A9F4;
		}

		#container {
			position: relative;
			background: #ffffff;
			display: block;
			width: 600px;
			height: 600px;
		}

		#htmlCanvas {
			position: absolute;
			display: block;
			top: 100px;
			left: 0;
			width: 600px;
			height: 500px;
		}

		#gameOverlay {
			position: absolute;
			box-sizing: border-box;
			padding: 16px;
			color: #fff;
			background: #009688;
			width: 600px;
			height: 100px;
		}

		#timeAttackText {
			display: block;
			float: right;
		}

		#scoreText {
			display: block;
			float: left;
			font-size: 25px;
		}

		#gameOverOverlay {
			color: #fff;
			background-color: #009688;
			box-sizing: border-box;
			padding: 16px;
			position: absolute;
			z-index: 4;
			left: 150px;
			width: 300px;
			height: 130px;
			top: 245px; 
		}

		#label {
			font-weight: 500;
			font-size: 23px;
		}

		#gameOverOverlay paper-button {
			float: right;
			margin-top: 12px;
			margin-right: -7px;
		}

		#gameOverScore {
			padding-top: 6px;
			font-size: 16px;
		}


	</style>

	<div id="container">

		<paper-shadow z="2" id="gameOverlay">
				
				<div id="timeAttackText"></div>
				<div id="scoreText"></div>

		</paper-shadow>

		<paper-ripple class="game-ripple" id="foodRipple" style="pointer-events: none;"></paper-ripple>
		<paper-ripple class="game-ripple" id="bugRipple" style="pointer-events: none;"></paper-ripple>
			
		<paper-shadow z="2" id="htmlCanvas">
			
		</paper-shadow>

		<paper-shadow z="3" id="gameOverOverlay" hidden="gameOver">

			<div id="label">Game Over!</div>
			<div id="gameOverScore">Score: 100 Points</div>

			<paper-button on-tap="retry">Retry</paper-button>
			<paper-button on-tap="quit">Quit</paper-button>

		</paper-shadow>
		
	</div>
		
	</template>
	<script>
	(function() {

	var state = {};

	Polymer('duarte-game', {
		mode: false,
		ready: function() {
			timeAttackTimeElement = $(this.$.timeAttackText);
			scoreTextElement = $(this.$.scoreText);
			gameOverOverlay = $(this.$.gameOverOverlay);
			gameOverScore = $(this.$.gameOverScore);
			foodRipple = $(this.$.foodRipple);
			bugRipple = $(this.$.bugRipple);
			htmlCanvas = $(this.$.htmlCanvas);
			
			this.game = new Game(htmlCanvas, this.gameMode);

			this.game.gameStateChanged = this.onGameStateChanged.bind(this);
		},
		onRouteLeave: function() {
			// state = this.game.saveState();
		},
		retry: function() {
			gameOver = false;
		},
		quit: function() {

		},
		onGameStateChanged: function(state) {
			//Jag Ã¤r inte efterbliven, ska utveckla detta senare
			if (state == 'over') {
				gameOver = true;
			} else {
				gameOver = false;
			}
		},
		gameOver: false,
		gameMode: 'normal'

	});

	})();

  </script>
</polymer-element>