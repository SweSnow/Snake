<link rel="import" href="../components/paper-dropdown/paper-dropdown-menu.html">
<link rel="import" href="../components/paper-ripple/paper-ripple.html">
<link rel="import" href="../components/core-ajax/core-ajax.html">

<link rel="import" href="../duarte-components/duarte-map.html">

<polymer-element name="duarte-browse">
  <template>

	<style>

		:host {
			display: block;
			background-color: #efefef;
		}

		#header-container {
			padding-left: 48px;
			padding-right: 48px;
			background-color: #00695c;
			color: #fff;
			fill: #fff;
		}

		#header {
			margin: auto;
			max-width: 1100px;
			background-color: #00695c;
		}

		#maps-container {
			padding-left: 32px;
			padding-right: 32px;
			max-width: 1100px;
			margin-top: 32px;
			margin-left: auto;
			margin-right: auto;
		}

		.map {
			cursor: pointer;
			border-radius: 4px;
			background-color: #ffffff;
			width: 350px;
			height: 410px;
			position: relative;
			display: inline-block;
			transition: background-color 0.4s;
		}

		.map:active {
			background-color: #ddd;
		}

		.map-title {
			padding: 16px;
			font-weight: 300;
			color: #444;
			font-size: 1.7em;
		}

		.map-ripple {
			color: #009688;
		}

		.duarte-thumbnail {
			width: 350px;
			height: 350px;
		}

		.subheader-dropdown-label  {
			margin-top: 26px;
			font-size: 0.8em;
		}

		.subheader-dropdown {
			width: 130px;
			margin-left: 32px;
			color: #fff;
			fill: #fff;
			background-color: transparent;
		}

		.subheader-dropdown::shadow core-icon {
			fill: #fff;
		}

		.subheader-dropdown::shadow #control div {
			color: #fff;
			font-size: 0.8em;
		}	
		
		.subheader-dropdown::shadow #control {
			border-bottom: 1px solid #ccc;
		}	

		.subheader-dropdown /deep/ #ripple {
			color: #888;
		}

		#header > div > paper-dropdown-menu > paper-item {
			color: #333;
		}

		::selection {
			/*	#009688 with rgba 70% opacity: */;
			background-color: rgba(0, 150, 136, 0.7);
			color: #fff;
		}

		-moz-::selection {
			/*	#009688 with rgba 70% opacity: */;
			background-color: rgba(0, 150, 136, 0.7);
			color: #fff;
		}

	</style>
	
	<paper-shadow z="1" id="header-container">
		<core-toolbar id="header">

			<div class="bottom fit" horizontal layout>

				<div class="subheader-dropdown-label">Sort by:</div>
				<paper-dropdown-menu class="subheader-dropdown" selected="Popularity" valueattr="label">

					<paper-item label="Newest">Newest</paper-item>
					<paper-item label="Popularity">Popularity</paper-item>
					<paper-item label="Rating">Rating</paper-item>
					
				</paper-dropdown-menu>
		  
			</div>

		</core-toolbar>
	</paper-shadow>

	{{levels.length}}
	<div id="maps-container">
		<core-ajax
			id="get"
			auto="true"
			method="get"
			body='{"from": "0", "length": "10", "sort": "-time"}'
			url="http://192.168.0.189:8080/level/interval"
			on-core-response="{{onResponse}}"
			contentType="application/json"
			withCredentials="true"
			></core-ajax>

		<template repeat="{{map in levels}}">
			<paper-shadow z="1" vertical layout class="map" on-tap="{{mapClick}}">
				<paper-shadow z="1"></paper-shadow>
				<duarte-map grid="{{map.grid}}" class="duarte-thumbnail">
					<paper-ripple fit class="map-ripple"></paper-ripple>
				</duarte-map>

				<div class="map-title">{{map.title}}</div>
			</paper-shadow>
		</template>
	</div>

  </template>
  <script>
	Polymer('duarte-browse', {
		onResponse: function(e, detail) {
			this.levels = JSON.parse(detail.response);
			console.log(this.levels);
	  	},
	  	mapClick: function() {

	  	}
	  
	  //http://www.polymer-project.org/docs/elements/paper-elements.html#paper-dropdown
	  
	});
  </script>
</polymer-element>